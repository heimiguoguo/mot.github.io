import{v as e,F as o,r as l,I as b,S as g,P as k,D as h,H as P,a4 as S}from"./index-DWUUnCU6.js";const C=e.createContext(null),I=e.createContext({}),D=({index:i,...s})=>{const t=s["data-row-key"],[a]=o.useForm(),{formMap:m}=l.useContext(I);return l.useEffect(()=>(t!==void 0&&(m[t]=a),()=>{t!==void 0&&delete m[t]}),[]),e.createElement(o,{name:`friend-${t}`,form:a,component:!1},e.createElement(C.Provider,{value:a},e.createElement("tr",{...s})))},L=({title:i,children:s,dataIndex:t,record:a,FormItem:m,handleSave:p,...w})=>{const E=l.useContext(C);l.useEffect(()=>{t&&a&&a[t]!==void 0&&E.setFieldsValue({[t]:a[t]})},[]);const y=async()=>{try{const c=await E.validateFields();p({...a,...c})}catch(c){console.log("Save failed:",c)}};let f=s;return f=m?e.createElement(m,{disabled:!1,save:y}):e.createElement("div",{className:"editable-cell-value-wrap",style:{paddingRight:24}},s),e.createElement("td",{...w},f)},{Option:R}=g,v={},q=l.forwardRef((i,s)=>{const[t,a]=l.useState([]),[m,p]=l.useState(2);l.useEffect(()=>{a([{key:"0",name:"Edward King 0",age:32,address:"London, Park Lane no. 0"},{key:"1",name:"Edward King 1",age:32,address:"London, Park Lane no. 1"}]),p(2)},[]);const w=n=>{const r=t.filter(d=>d.key!==n);a(r)},E=()=>{const n={key:m,name:"",age:null,address:""};a([...t,n]),p(m+1)},y=n=>{const r=[...t],d=r.findIndex(x=>n.key===x.key),u=r[d];r.splice(d,1,{...u,...n}),a(r)},f=async()=>Object.entries(v).length?await Promise.all(Object.values(v).map(n=>n.validateFields())):new Promise((n,r)=>{S.warn("请至少添加一个紧急联系人"),r("请至少添加一个紧急联系人")});l.useImperativeHandle(s,()=>({validateFormList:f}));const c={body:{row:D,cell:L}},F=[{title:"name",dataIndex:"name",width:"30%",FormItem:({disabled:n,save:r})=>e.createElement(o.Item,{name:"name",rules:[{required:!0}]},e.createElement(b,{style:{width:"100%"}}))},{title:"age",dataIndex:"age",FormItem:({disabled:n,save:r})=>e.createElement(o.Item,{name:"age",rules:[{required:!0}]},e.createElement(g,{style:{width:"100%"}},Array.from({length:99}).map((d,u)=>e.createElement(R,{key:u,label:u+1},u+1))))},{title:"address",dataIndex:"address"},{title:"operation",dataIndex:"operation",render:(n,r)=>t.length>=1?e.createElement(k,{title:"Sure to delete?",onConfirm:()=>w(r.key)},e.createElement("a",null,"Delete")):null}].map(n=>({...n,onCell:r=>({record:r,dataIndex:n.dataIndex,title:n.title,FormItem:n.FormItem,handleSave:y})}));return e.createElement("div",null,e.createElement(h,{onClick:E,type:"primary",style:{marginBottom:16}},"Add a row"),e.createElement(I.Provider,{value:{formMap:v}},e.createElement(P,{components:c,rowClassName:()=>"editable-row",bordered:!0,dataSource:t,columns:F})))}),A=()=>{const i=l.useRef(null),s=a=>{i.current.validateFormList(),console.log("Success:",a)},t=a=>{console.log("Failed:",a)};return e.createElement(o,{name:"basic",labelCol:{span:2},wrapperCol:{span:6},initialValues:{remember:!0},onFinish:s,onFinishFailed:t,autoComplete:"off"},e.createElement(o.Item,{label:"Username",name:"username",rules:[{required:!0,message:"Please input your username!"}]},e.createElement(b,null)),e.createElement(o.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your password!"}]},e.createElement(b.Password,null)),e.createElement(o.Item,{label:"紧急联系人",wrapperCol:{span:20}},e.createElement(q,{ref:i})),e.createElement(o.Item,{wrapperCol:{offset:2,span:20}},e.createElement(h,{type:"primary",htmlType:"submit"},"Submit")))},K=()=>e.createElement("div",{className:"hello world",style:{height:"100%"}},e.createElement(A,null));export{K as default};
